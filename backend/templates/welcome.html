{% block title %}Welcome — TribalConnect{% endblock %}
{% block content %}
<div class="auth-card maxw-640 mt-2rem mx-auto">
  <h1>Welcome to TribalConnect</h1>
  <p class="muted">Choose your tribe to personalize your experience. You can add your Tribal ID now or later.</p>

  {% if message %}
  <p class="muted text-success mt-3">{{ message }}</p>
  {% endif %}

  {% if error %}
  <p class="muted text-danger mt-3">{{ error }}</p>
  {% endif %}

  {% if current_user %}
  <p class="mt-2">Signed in as <strong>{{ current_user.username }}</strong> ({{ current_user.email }})</p>
  <form action="/onboarding/tribe" method="post" class="mt-3" novalidate>
    <label for="tribe_id">Your Tribe</label>
    <select id="tribe_id" name="tribe_id" required>
      <option value="" disabled {% if not current_user or current_user.tribe_id %}selected{% endif %}>
        Select a tribe</option>
      <option value="1" {% if current_user and current_user.tribe_id == 1 %}selected{% endif %}>Snoqualmie Tribe
      </option>
      <option value="2" {% if current_user and current_user.tribe_id == 2 %}selected{% endif %}>Tulalip Tribes</option>
      <option value="3" {% if current_user and current_user.tribe_id == 3 %}selected{% endif %}>Yakama Nation</option>
    </select>

    <label for="tribal_id_number" class="mt-2">Tribal ID # (optional)</label>
    <input id="tribal_id_number" name="tribal_id_number" type="text"
      value="{{ current_user.tribal_id_number if current_user and current_user.tribal_id_number else '' }}"
      placeholder="e.g., 123456" />

    <button type="submit" class="mt-3">Save & Continue</button>
  </form>

  {% if current_user.is_verified %}
  <p class="muted mt-3">✅ Membership verified. <a href="/tribal-portal">Enter your Tribal Portal</a>
  </p>
  {% else %}
  <p class="muted mt-3">⏳ Membership pending verification by enrollment staff. You can still browse
    public sections.</p>
  {% endif %}

  <form action="/logout" method="post" class="mt-3">
    <button type="submit">Log out</button>
  </form>
  {% else %}
  <p class="muted mt-3">Please <a href="{{ request.url_for('login_page') }}">log in</a> first.</p>
  {% endif %}
</div>
{% endblock %}